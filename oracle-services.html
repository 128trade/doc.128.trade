<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Oracle Services | 128.trade</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="A Smart-Contract Callable Trading Engine for Any Chain">
    <meta name="author" content="128.trade Team">
    <meta name="keywords" content="DeFi, trading engine, smart contracts, cross-chain, perpetual futures, CLOB">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/doc.128.trade/assets/css/0.styles.9f274d07.css" as="style"><link rel="preload" href="/doc.128.trade/assets/js/app.2ce44126.js" as="script"><link rel="preload" href="/doc.128.trade/assets/js/2.076bd69b.js" as="script"><link rel="preload" href="/doc.128.trade/assets/js/1.d02bef9a.js" as="script"><link rel="preload" href="/doc.128.trade/assets/js/28.1f7133bc.js" as="script"><link rel="prefetch" href="/doc.128.trade/assets/js/10.575887cc.js"><link rel="prefetch" href="/doc.128.trade/assets/js/11.e055bbb5.js"><link rel="prefetch" href="/doc.128.trade/assets/js/12.212853c2.js"><link rel="prefetch" href="/doc.128.trade/assets/js/13.efc55b1a.js"><link rel="prefetch" href="/doc.128.trade/assets/js/14.d2696e63.js"><link rel="prefetch" href="/doc.128.trade/assets/js/15.e0bb9591.js"><link rel="prefetch" href="/doc.128.trade/assets/js/16.382c379a.js"><link rel="prefetch" href="/doc.128.trade/assets/js/17.8935d659.js"><link rel="prefetch" href="/doc.128.trade/assets/js/18.aa61f7ff.js"><link rel="prefetch" href="/doc.128.trade/assets/js/19.fa3b80ad.js"><link rel="prefetch" href="/doc.128.trade/assets/js/20.a996495d.js"><link rel="prefetch" href="/doc.128.trade/assets/js/21.e3aa8756.js"><link rel="prefetch" href="/doc.128.trade/assets/js/22.ce37ac2a.js"><link rel="prefetch" href="/doc.128.trade/assets/js/23.cdbab0dc.js"><link rel="prefetch" href="/doc.128.trade/assets/js/24.bce8ddf2.js"><link rel="prefetch" href="/doc.128.trade/assets/js/25.b3a7e129.js"><link rel="prefetch" href="/doc.128.trade/assets/js/26.4e717056.js"><link rel="prefetch" href="/doc.128.trade/assets/js/27.72e958a9.js"><link rel="prefetch" href="/doc.128.trade/assets/js/29.e401b319.js"><link rel="prefetch" href="/doc.128.trade/assets/js/3.50a424eb.js"><link rel="prefetch" href="/doc.128.trade/assets/js/30.ee24f801.js"><link rel="prefetch" href="/doc.128.trade/assets/js/4.5d864173.js"><link rel="prefetch" href="/doc.128.trade/assets/js/5.8998270b.js"><link rel="prefetch" href="/doc.128.trade/assets/js/6.dde3633f.js"><link rel="prefetch" href="/doc.128.trade/assets/js/7.f3b9417f.js"><link rel="prefetch" href="/doc.128.trade/assets/js/vendors~docsearch.6fed1ae2.js">
    <link rel="stylesheet" href="/doc.128.trade/assets/css/0.styles.9f274d07.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/doc.128.trade/" class="home-link router-link-active"><!----> <span class="site-name">128.trade</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>üìÑ Whitepaper</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/doc.128.trade/" aria-current="page" class="sidebar-link">Cover</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/#a-smart-contract-callable-trading-engine-for-any-chain" class="sidebar-link">A Smart-Contract Callable Trading Engine for Any Chain</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/#table-of-contents" class="sidebar-link">Table of Contents</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/#document-information" class="sidebar-link">Document Information</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/#executive-summary" class="sidebar-link">Executive Summary</a></li></ul></li><li><a href="/doc.128.trade/introduction.html" class="sidebar-link">1. Introduction</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/introduction.html#_1-1-structural-problems-in-today-s-dex-architectures" class="sidebar-link">1.1 Structural Problems in Today's DEX Architectures</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/introduction.html#_1-2-evolution-of-decentralised-exchange-architectures" class="sidebar-link">1.2 Evolution of Decentralised Exchange Architectures</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/introduction.html#_1-3-why-smart-contract-callability-matters" class="sidebar-link">1.3 Why Smart-Contract Callability Matters</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/introduction.html#_1-4-our-solution-a-smart-contract-callable-trading-engine-accessible-from-any-chain" class="sidebar-link">1.4 Our Solution: A Smart-Contract Callable Trading Engine Accessible from Any Chain</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/introduction.html#this-paper-contributes" class="sidebar-link">This paper contributes:</a></li></ul></li></ul></li><li><a href="/doc.128.trade/vision.html" class="sidebar-link">2. Vision</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/vision.html#_2-1-the-name-and-its-significance" class="sidebar-link">2.1 The Name and Its Significance</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/vision.html#_2-2-our-vision-for-the-future" class="sidebar-link">2.2 Our Vision for the Future</a></li></ul></li><li><a href="/doc.128.trade/architecture.html" class="sidebar-link">3. Architecture Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#_3-1-core-modules" class="sidebar-link">3.1 Core Modules</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#trading-engine-execution-layer" class="sidebar-link">Trading Engine (Execution Layer)</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#oracle-services-access-messaging-layer" class="sidebar-link">Oracle Services (Access &amp; Messaging Layer)</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#_3-2-dual-service-modes" class="sidebar-link">3.2 Dual Service Modes</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#_3-3-end-to-end-system-flows" class="sidebar-link">3.3 End-to-End System Flows</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#direct-engine-access" class="sidebar-link">Direct Engine Access</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#smart-contract-access-via-oracle-services" class="sidebar-link">Smart-Contract Access via Oracle Services</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/architecture.html#_3-4-key-architectural-considerations" class="sidebar-link">3.4 Key Architectural Considerations</a></li></ul></li><li><a href="/doc.128.trade/trading-engine.html" class="sidebar-link">4. Trading Engine</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#_4-1-accounts-sub-accounts-and-market-support" class="sidebar-link">4.1 Accounts, Sub-Accounts, and Market Support</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#_4-2-request-ingestion-and-authentication" class="sidebar-link">4.2 Request Ingestion and Authentication</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#api-origin-requests-signature-based-authentication" class="sidebar-link">API-Origin Requests (Signature-Based Authentication)</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#on-chain-origin-requests-gateway-provenance-verification" class="sidebar-link">On-Chain-Origin Requests (Gateway-Provenance Verification)</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#unified-request-queue" class="sidebar-link">Unified Request Queue</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#_4-3-bft-multi-node-network-and-deterministic-execution" class="sidebar-link">4.3 BFT Multi-Node Network and Deterministic Execution</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#_4-4-enhancement-roadmap-tee-and-zk-proofs" class="sidebar-link">4.4 Enhancement Roadmap: TEE and ZK Proofs</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/trading-engine.html#_4-5-risk-engine-liquidation-and-auditability" class="sidebar-link">4.5 Risk Engine, Liquidation, and Auditability</a></li></ul></li><li><a href="/doc.128.trade/oracle-services.html" aria-current="page" class="active sidebar-link">5. Oracle Services</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-1-overview-and-design-goals" class="sidebar-link">5.1 Overview and Design Goals</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-2-request-lifecycle-from-on-chain-intent-to-verified-execution" class="sidebar-link">5.2 Request Lifecycle: From On-Chain Intent to Verified Execution</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-3-gateway-contracts" class="sidebar-link">5.3 Gateway Contracts</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-4-relayer-network" class="sidebar-link">5.4 Relayer Network</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-5-callback-proof-verification-logic" class="sidebar-link">5.5 Callback &amp; Proof Verification Logic</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-6-asset-mapping-settlement-integration" class="sidebar-link">5.6 Asset Mapping &amp; Settlement Integration</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#_5-7-safety-and-liveness-guarantees" class="sidebar-link">5.7 Safety and Liveness Guarantees</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#fully-permissionless-callback-mechanism" class="sidebar-link">Fully Permissionless Callback Mechanism</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#emergency-exit-via-fraud-proof-roll-up-escape-hatch" class="sidebar-link">Emergency Exit via Fraud-Proof Roll-up Escape Hatch</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/oracle-services.html#combined-security-guarantees" class="sidebar-link">Combined Security Guarantees</a></li></ul></li></ul></li><li><a href="/doc.128.trade/applications.html" class="sidebar-link">6. Applications and New Design Space</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_6-1-trading-as-a-programmable-primitive" class="sidebar-link">6.1 Trading as a Programmable Primitive</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_6-2-foundational-financial-primitives" class="sidebar-link">6.2 Foundational Financial Primitives</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#spot-execution-primitive" class="sidebar-link">Spot Execution Primitive</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#perpetual-execution-primitive" class="sidebar-link">Perpetual Execution Primitive</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#unified-margin-subaccount-primitive" class="sidebar-link">Unified Margin &amp; Subaccount Primitive</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#vault-subscription-primitive" class="sidebar-link">Vault Subscription Primitive</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#asset-mapping-primitive" class="sidebar-link">Asset Mapping Primitive</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_6-3-a-new-paradigm-of-composable-defi-applications" class="sidebar-link">6.3 A New Paradigm of Composable DeFi Applications</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_1-higher-capital-efficiency-through-universal-asset-mapping" class="sidebar-link">(1) Higher Capital Efficiency Through Universal Asset Mapping</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_2-a-more-expressive-and-efficient-trading-system-for-defi" class="sidebar-link">(2) A More Expressive and Efficient Trading System for DeFi</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_3-improving-and-redefining-existing-defi-protocols" class="sidebar-link">(3) Improving and Redefining Existing DeFi Protocols</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_3-1-the-evolution-of-amm-dexs" class="sidebar-link" style="padding-left:3rem;">(3.1) The Evolution of AMM DEXs</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_3-2-lending-protocols-as-intelligent-risk-management-banks" class="sidebar-link" style="padding-left:3rem;">(3.2) Lending Protocols as Intelligent Risk-Management Banks</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_4-entirely-new-protocol-classes-enabled-by-programmable-execution" class="sidebar-link">(4) Entirely New Protocol Classes Enabled by Programmable Execution</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_4-1-fully-on-chain-structured-products-and-autonomous-funds" class="sidebar-link" style="padding-left:3rem;">(4.1) Fully On-Chain Structured Products and Autonomous Funds</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_4-2-on-chain-autonomous-agents-ai-or-algorithmic" class="sidebar-link" style="padding-left:3rem;">(4.2) On-Chain Autonomous Agents (AI or Algorithmic)</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_6-4-why-these-applications-were-previously-impossible" class="sidebar-link">6.4 Why These Applications Were Previously Impossible</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_1-amms-provide-programmability-but-lack-expressive-execution" class="sidebar-link">(1) AMMs provide programmability but lack expressive execution</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#_2-cexs-and-order-book-dexs-support-rich-execution-but-cannot-be-composed" class="sidebar-link">(2) CEXs and order-book DEXs support rich execution but cannot be composed</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#a-structural-gap" class="sidebar-link">A structural gap</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/applications.html#how-128-trade-resolves-this" class="sidebar-link">How 128.trade resolves this</a></li></ul></li></ul></li><li><a href="/doc.128.trade/features.html" class="sidebar-link">7. Additional Features</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#_7-1-dex-aggregator" class="sidebar-link">7.1 DEX Aggregator</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#architecture-technical-design" class="sidebar-link">Architecture &amp; Technical Design</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#_7-2-fund-management-smart-contract-governance" class="sidebar-link">7.2 Fund Management &amp; Smart-Contract Governance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#smart-contract-governed-fund-structures" class="sidebar-link">Smart-Contract-Governed Fund Structures</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#strategy-library-and-tokenised-participation" class="sidebar-link">Strategy Library and Tokenised Participation</a></li><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#risk-control-transparency-and-composability" class="sidebar-link">Risk-Control, Transparency and Composability</a></li></ul></li><li class="sidebar-sub-header"><a href="/doc.128.trade/features.html#_7-3-privacy-protection" class="sidebar-link">7.3 Privacy Protection</a></li></ul></li><li><a href="/doc.128.trade/conclusion.html" class="sidebar-link">8. Conclusion</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_5-oracle-services"><a href="#_5-oracle-services" class="header-anchor">#</a> 5. Oracle Services</h1> <p>The Oracle Services module constitutes the access and cross-chain messaging layer of 128.trade. Because smart contracts cannot interact directly with an off-chain high-performance engine, this module provides the infrastructure required to transport requests from heterogeneous chains to the Trading Engine and to return authenticated, verifiable execution results back on-chain. It consists of four coordinated subcomponents: gateway contracts, a decentralised relayer network, callback and proof-verification logic, and the asset-mapping interface‚Äîwhich together expose the engine as a contract-callable execution primitive for the multi-chain DeFi ecosystem.</p> <h2 id="_5-1-overview-and-design-goals"><a href="#_5-1-overview-and-design-goals" class="header-anchor">#</a> 5.1 Overview and Design Goals</h2> <p>The Oracle Services layer is designed around four primary goals:</p> <ul><li><p><strong>Any-chain programmability</strong>. Smart contracts on heterogeneous chains must be able to invoke the Trading Engine as if it were a native module, without introducing new trust assumptions or bespoke bridging interfaces.</p></li> <li><p><strong>Verifiable correctness</strong>. Returned results must be accompanied by proof bundles that allow the gateway contract to verify that off-chain execution was performed faithfully and deterministically.</p></li> <li><p><strong>Deterministic and replay-safe integration</strong>. Each request is uniquely identified, idempotent and safely sequenced, ensuring consistent state updates across chains.</p></li> <li><p><strong>High throughput and asynchronous workflows</strong>. The messaging layer must support concurrent requests, pipelined callbacks and scalable multi-chain operation.</p></li></ul> <p>To realise these goals, Oracle Services comprise four coordinated submodules:</p> <ol><li>Gateway Contracts (on-chain access layer),</li> <li>Relayer Network (off-chain messaging and validation layer),</li> <li>Callback &amp; Proof Verification Logic (on-chain authenticity enforcement),</li> <li>Asset Mapping &amp; Settlement Interface (representation and settlement of engine-native state across chains).</li></ol> <h2 id="_5-2-request-lifecycle-from-on-chain-intent-to-verified-execution"><a href="#_5-2-request-lifecycle-from-on-chain-intent-to-verified-execution" class="header-anchor">#</a> 5.2 Request Lifecycle: From On-Chain Intent to Verified Execution</h2> <p>The end-to-end lifecycle linking an on-chain contract to the Trading Engine proceeds through the following verifiable stages:</p> <ol><li><p><strong>On-chain request initiation</strong>. A contract on chain X calls a gateway <code>request()</code> function (e.g., <code>requestOpenPosition</code>), which generates a unique <code>requestId</code>. The gateway emits an event encoding parameters, chain context and caller metadata.</p></li> <li><p><strong>Relayer event detection and provenance validation</strong>. The decentralised relayer network monitors gateway events, verifies origin-chain metadata and optional light-client proofs, and constructs a canonical request payload for off-chain execution.</p></li> <li><p><strong>Delivery to the Trading Engine</strong>. Relayers submit the validated request to the engine through authenticated channels. The engine authenticates the message and inserts it into its deterministic execution queue.</p></li> <li><p><strong>Engine execution and result generation</strong>. The Trading Engine processes the request, matching, margining, funding, liquidating or settling as appropriate, and outputs a deterministic execution result and associated batch identifier.</p></li> <li><p><strong>Proof generation and attestation</strong>. Relayers collectively generate a proof bundle attesting to the correctness of the engine result. This bundle may include threshold signatures, TEE attestation metadata, or future ZK proofs generated from the engine's deterministic audit log.</p></li> <li><p><strong>Callback delivery to chain X</strong>. A relayer (or any permissionless actor) submits the proof-backed result to the gateway's <code>callback()</code> function, along with identifiers such as <code>requestId</code> and <code>batchId</code>.</p></li> <li><p><strong>Gateway verification and state materialisation</strong>. The gateway verifies the proof bundle, enforces idempotency and replay protection, and applies the result on-chain, minting or transferring position NFTs, updating balances or notifying the invoking contract.</p></li></ol> <p>This lifecycle ensures that the Trading Engine can be invoked from any chain while maintaining correctness, authenticity and deterministic reconciliation.</p> <h2 id="_5-3-gateway-contracts"><a href="#_5-3-gateway-contracts" class="header-anchor">#</a> 5.3 Gateway Contracts</h2> <p>Gateway contracts form the canonical on-chain interface to 128.trade. They expose a family of deterministic functions that encode decentralised intent:</p> <ul><li><code>request</code> functions such as <code>requestPlaceOrder</code>, which allow smart contracts to initiate engine-side actions;</li> <li><code>callback</code> functions such as <code>onOrderResult</code>, through which verifiable engine results and proof bundles are delivered back on-chain.</li></ul> <p>The gateway contract enforces strict checks: correct request identifiers, replay-protection via nonces or <code>requestIds</code>, verification of relayer signatures or threshold signatures, and (where applicable) verification of state roots or proofs from the underlying bridge or light-client. This design ensures that only authorised and valid results are applied on-chain.</p> <h2 id="_5-4-relayer-network"><a href="#_5-4-relayer-network" class="header-anchor">#</a> 5.4 Relayer Network</h2> <p>The decentralised relayer network forms the off-chain messaging and validation layer responsible for transporting requests to the Trading Engine and returning authenticated results. Its responsibilities include provenance verification, request canonicalisation, delivery to the engine, and generation of cryptographic attestations that certify the correctness of the engine's deterministic execution.</p> <ul><li><p><strong>Event observation &amp; provenance validation</strong>. Relayers monitor gateway events across supported chains, verify origin-chain metadata, and (when available) validate light-client or state-root proofs to ensure that the request originated from the correct chain and gateway.</p></li> <li><p><strong>Canonical request construction</strong>. Relayers normalise request parameters, constructing a canonical payload that the Trading Engine can authenticate and execute deterministically.</p></li> <li><p><strong>Authenticated request delivery</strong>. Validated requests are forwarded to the Trading Engine via authenticated channels. Once inside the engine, all requests‚ÄîAPI or on-chain‚Äîenter the same deterministic execution queue.</p></li> <li><p><strong>Execution-proof generation</strong>. After the engine produces a deterministic result, relayers jointly generate an execution proof bundle that attests to correctness. The proof bundle may be instantiated using multiple verification mechanisms:</p> <ul><li>Threshold-signature attestation (e.g., M-of-N signatures certifying agreement on engine output);</li> <li>TEE-based remote attestation (proving the result was generated by an audited engine binary running in a secure enclave);</li> <li>Light-client provenance proofs (showing the request was included in the canonical chain state);</li> <li>Zero-knowledge proofs (future extension), generated from the engine's deterministic audit log to prove state transitions without revealing internal data.</li></ul></li> <li><p><strong>Callback preparation</strong>. Equipped with a valid proof bundle, any relayer (or permissionless actor) can construct and submit a callback transaction to the destination chain.</p></li></ul> <p>The design follows principles from modern off-chain reporting networks such as Chainlink OCR, but extends them: relayers here certify not just observed data, but the correctness of state transitions performed by a high-performance deterministic execution engine.</p> <h2 id="_5-5-callback-proof-verification-logic"><a href="#_5-5-callback-proof-verification-logic" class="header-anchor">#</a> 5.5 Callback &amp; Proof Verification Logic</h2> <p>Once a callback transaction carrying an execution proof bundle reaches the gateway contract, verification proceeds entirely on-chain. This separation provides a clean security boundary: relayers produce proofs; gateways verify them.</p> <ul><li><p><strong>Proof-bundle verification</strong>. The gateway verifies the cryptographic proof bundle attached to the execution result. Supported proof types include:</p> <ul><li>threshold-signature sets (certifying multi-relayer agreement),</li> <li>TEE attestation metadata (certifying the engine binary and execution environment),</li> <li>zero-knowledge proofs (certifying state-transition correctness directly from deterministic logs).</li></ul></li> <li><p><strong>Request and batch integrity</strong>. The gateway checks the <code>requestId</code>, <code>batchId</code>, and canonical payload fields to ensure the callback corresponds exactly to a previously issued request.</p></li> <li><p><strong>Replay protection &amp; idempotency</strong>. State transitions are applied exactly once. Any callback failing nonce or idempotency checks is rejected.</p></li></ul> <p>Upon successful verification, the gateway materialises the validated result on-chain‚Äîfor example, minting or updating position NFTs, transferring vault shares, or notifying the invoking contract. This ensures that on-chain state transitions faithfully reflect authenticated deterministic execution of the Trading Engine, even in adversarial conditions.</p> <h2 id="_5-6-asset-mapping-settlement-integration"><a href="#_5-6-asset-mapping-settlement-integration" class="header-anchor">#</a> 5.6 Asset Mapping &amp; Settlement Integration</h2> <p>The Oracle/Relayer layer also interacts with the asset-mapping system of 128.trade. For example:</p> <ul><li><p>Spot assets from various chains may be mapped into the engine as virtual liquidity endpoints; the gateway contract and relayer network ensure the transfer of asset-mapping instructions and settlement notifications.</p></li> <li><p>Perpetual positions (represented as NFTs) may be created or transferred via callback events, with proofs of execution delivered through the oracle network.</p></li> <li><p>Vault shares (ERC-20 tokens) may be minted on chain X after the trading engine executes a vault-subscription request; the relayer network ensures the correct state has been achieved before the minting callback.</p></li></ul> <h2 id="_5-7-safety-and-liveness-guarantees"><a href="#_5-7-safety-and-liveness-guarantees" class="header-anchor">#</a> 5.7 Safety and Liveness Guarantees</h2> <p>To ensure robust operation of the oracle/relayer subsystem in 128.trade, we design specific mechanisms that address both safety (i.e., &quot;bad things do not happen&quot;) and liveness (i.e., &quot;good things eventually happen&quot;) in the context of cross-chain request/response flows. In classical distributed systems literature, safety and liveness are fundamental properties of protocols.</p> <h3 id="fully-permissionless-callback-mechanism"><a href="#fully-permissionless-callback-mechanism" class="header-anchor">#</a> Fully Permissionless Callback Mechanism</h3> <p>Even if the relayer set becomes unavailable or incapacitated (for example by network faults, censorship or operator failure), users on any chain can still complete the request-to-engine workflow and apply the result on-chain. Concretely: when a smart contract on chain X submits a <code>request()</code> via the gateway contract, the matching/trading engine executes the request and emits a signed or verifiable proof of execution (e.g., threshold-signature, ZK-proof or attested state root). A third-party user or contract may then invoke the <code>callback()</code> on chain X by presenting the execution result and proof directly, without relying on any designated relayer. This design ensures that funds and positions are not locked indefinitely due to relayer downtime: the safety property holds because only valid proofs are accepted, and liveness is improved because any actor can progress the callback.</p> <h3 id="emergency-exit-via-fraud-proof-roll-up-escape-hatch"><a href="#emergency-exit-via-fraud-proof-roll-up-escape-hatch" class="header-anchor">#</a> Emergency Exit via Fraud-Proof Roll-up Escape Hatch</h3> <p>To further guarantee liveness and protect users in worst-case failures of the engine or the relayer network, we incorporate an emergency escape mechanism akin to optimistic roll-up fraud-proof systems. When a user has placed an order on chain X and the engine or relayer network fails to deliver a callback within a predetermined challenge period, the user may initiate an on-chain &quot;challenge&quot; via the gateway contract:</p> <ol><li><p>The user submits their <code>requestId</code>, evidence of submission (e.g., event log, timestamp) and a proof that no valid callback has arrived within the window.</p></li> <li><p>If the engine/relayer system does not supply a valid proof of execution within the challenge period, then the gateway contract allows the user to withdraw or reclaim funds/assets through a fallback path.</p></li></ol> <p>This mechanism ensures that liveness is preserved: honest users will not have funds indefinitely locked; and safety is preserved because the escape path is only triggered if the system fails to deliver a valid execution proof, thereby avoiding unjustified exits.</p> <h3 id="combined-security-guarantees"><a href="#combined-security-guarantees" class="header-anchor">#</a> Combined Security Guarantees</h3> <ul><li><p><strong>Safety</strong>: Only authorised, correctly signed/attested results from the trading engine are accepted. Replay attacks are prevented through unique <code>requestId</code> and batch identifiers; signature schemes or proof verification ensure authenticity and non-tampering.</p></li> <li><p><strong>Liveness</strong>: The permissionless callback path and the fraud-proof escape mechanism guarantee that, under benign conditions or worst-case failure conditions, users retain the ability to complete their requests or withdraw their assets.</p></li> <li><p><strong>Hybrid trust-minimisation</strong>: While relayers operate for performance and convenience, trust assumptions are minimised. The design does not depend exclusively on a single party or relayer set to sustain functionality.</p></li></ul> <p>In combination, these mechanisms extend the reliability of the oracle-relayer subsystem beyond typical designs and align with best practices in oracle/liveness research (e.g., ensuring freshness, fallback paths, decentralised relayers).</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ‚Üê
      <a href="/doc.128.trade/trading-engine.html" class="prev">
        4. Trading Engine
      </a></span> <span class="next"><a href="/doc.128.trade/applications.html">
        6. Applications and New Design Space
      </a>
      ‚Üí
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/doc.128.trade/assets/js/app.2ce44126.js" defer></script><script src="/doc.128.trade/assets/js/2.076bd69b.js" defer></script><script src="/doc.128.trade/assets/js/1.d02bef9a.js" defer></script><script src="/doc.128.trade/assets/js/28.1f7133bc.js" defer></script>
  </body>
</html>
